# EdgeGallery Security Compliance Test Case 4-2

|Test ID   |EG-TST-SEC-CP-4-2   |
| ------------ | ------------ |
|Test tool   |Nessus<br>Download URL:https://www.tenable.com/downloads/nessus?loginAttempted=true  |
|Test description   |Do not use insecure encryption algorithms<br>Check whether insecure encryption modes are used in the entire system.<br>Check whether the generation of the root key and working key is secure when the hierarchical key management structure is used.<br>Check whether the signature algorithm of the certificate generated or used by the system meets security requirements.   |
|Configuration Steps   |1.The system is running properly.<br>	2.Obtaining Product Source Codes and Related Documents<br>3.For network transmission, the communication between the client and server uses password authentication.<br>4.The product uses a hierarchical key management structure to distinguish between root keys and working keys.   |
|Step 1   |Check the code. The keys of the database, JWT, and certificate of the user/app/developer module are transferred through environment variables. Check whether the algorithms used for password encryption contain insecure cryptographic algorithms, such as DES and RC4 and RSA-1024, insecure hash algorithms SHA-0, SHA-1, MD2, MD4, and MD5, and insecure key negotiation algorithms DH-1024.   |
|Step 2   |Requirement 1:<br> Check whether the channel or encryption mode is secure.<br>1. Check whether the channel is encrypted using the TLS secure encryption channel according to the encryption algorithm specifications.<br>2. Check whether secure hash algorithms, such as sha256, are used to encrypt passwords that are irreversible based on the encryption algorithm specifications and whether security salts are added.<br>3. In scenarios where the encryption algorithm is reversible, check whether the reversible algorithm such as AES256 is used for encryption and whether the key is securely stored.<br>Requirement 2:<br> Check whether weak encryption algorithms and functions exist.<br>1. Use Nessus to scan the system and check whether weak encryption algorithms are used.<br>2. View the product documentation to find the feature description of sensitive design information.<br>3. Check whether the encryption mode of sensitive information meets requirements.<br>4. Search for the encryption function in the source code and check whether the encryption mode is proper.8|
|Step 3   |1. Search for the root key generation description in the product documentation or search for the root key generation code in the product source code to check whether the root key is hard coded in the product.<br>2.  If the root key uses the method of generating the initialization vector and key material, check whether the initialization vector and key material are hard-coded in the product.<br> Note: This can be combined with the urgent interviews with developers.   |
|Step 4   |Use the certificate generation function to check whether the number of RSA key pairs is optional. The default value is 2048 bits or more. Check whether the hash algorithm used for signatures is optional. Check whether the default value is SHA256 or a more complex hash algorithm.   |
|Step 5   |1. Analyze the working key usage based on the features supported by the product, search the source code, and check whether the working key is encrypted by the root key when being stored in the system, and whether different applications use different working keys.<br>2. Check the key usage process and check whether the key material is deleted in time after the key is used.<br>3. View the product documentation to check whether the root key and working key are described.<br>4. Check the product documentation to see whether the application scenario of the shared key exists. If yes, check the generation mode of the shared key.<br>Note: You can interview the R&D personnel based on.   |
|Test verdict   |1. Sensitive information must be encrypted and stored in the product. In scenarios where sensitive information is not required, an irreversible encryption algorithm must be used.<br>2. Proprietary encryption algorithms (including pseudo encryption implemented by Base64 encoding) are prohibited.<br>3. The encryption algorithms used by the product must meet the complexity requirements such as SHA256 and AES256.<br>4. The system does not store the root key, and generates the root key based on the initial vector and key material when needed.<br>5. Different types of services use different working keys and use the root key to encrypt and save keys. The working key and key materials are not provided. After the keys are used up, the memory for storing the information is cleared in a timely manner. In principle, the product does not provide an interface for sending the root key to the working key. When working keys are distributed between systems, encrypted transmission (direct encryption or SSL-based encryption) is required. It is recommended that the automatic key-up mechanism be used for negotiation between systems.<br>6. When the system generates a certificate, the default RSA key pair is 2048 or more, and the default signature algorithm is sha256, ase256, or a more complex algorithm. If a certificate with low algorithm complexity is supported, a security warning message is displayed. The RSA public key used by the system is 2048 bits or more, and the signature algorithm is sha2RSA or a more complex algorithm.   |
