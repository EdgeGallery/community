# EdgeGallery Vulnerability Management

EdgeGallery is very concerned about the security of the community. We encourage securiry researchers and industry organizations to actively report security issues in the community to the security working group. We will respond, analyze and resolve reported security issues or security vulnerabilities in a timely manner.

## Vulnerability Management Team

The EdgeGallery vulnerability management team (VMT) is responsible for coordinating the response to a reported vulnerability from initial reporting until coordinated disclosure.

Members of the team are independent and security-minded people who ensure that vulnerabilities are dealt with in a timely manner and that downstream stakeholders are notified in a coordinated and fair manner. Where a member of the team is employed by a downstream stakeholder, the member does not give their employer prior notice of any vulnerabilities. In order to reduce the disclosure of a vulnerability in the early stages, membership of this team is intentionally limited to a small number of people.

## Supported Projects & Versions

All EdgeGallery projects are currently in scope for vulnerability support. The vulnerability management team coordinates patches fixing vulnerabilities in master branches (corresponding to next major releases) of EdgeGallery.

## Vulnerability Management Process

Each security vulnerability is assigned a VMT *coordinator* that will drive the fixing and disclosure process. Here are the steps we follow.

![漏洞响应流程](https://images.gitee.com/uploads/images/2020/0708/145006_9618d8f3_7520247.png "vul-res.png")

### Issue Reception

A report can be received as a private encrypted email to the EdgeGallery secuiry email address(secureity@edgegallery.org). If you find a suspected security issue, please use the  _Security Issue Reporting Template_  to report it so that the vulnerability management team (VMT) is able to confirm and fix the issue as soon as possible with sufficient details. Your email will be confirmed within one working day. Within seven days, we will provide more detailed replies to the reported security issues and provide the next-step handling policy.

To ensure security, please use the PGP public key to encrypt your email before sending it.
- Security email address：security@edgegallery.org
- PGP public key:

```
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBF8G3IUBCADF35CV1a8zSu2MZDVhc/VxDtKxX5swTOL0jsNIAvDrZX9rYI9F
QGk27uQRCLVssSv6CRFAMSLQhsgqZm4N1HDvIcjrWEGK8cIIAgljYd59L+S6tMlM
Vx1dxOrahxTWgu/Rh9OCDxyqwVbia8VfYUeVkm64btXt1ECXGiIB1Q88BF2+4xvK
K4SstjUnKhMUv71ExQojlfplT7apVZ8ZVN6Ncb5XjK3KQsS8+4B2pkOFv4fUV9Xx
gnZ3Ae4mm5OQ+jHAzEEUntgzGnP9Xbz3LVtWcUtaWViJfFJcasoj9Zk/Q+LvFdzr
SRjEpaZj6Z/tGfMThHJAzmGfd8eeyE7a6HnjABEBAAG0L2VkZ2VnYWxsZXJ5X3Nl
Y3VyaXR5IDxzZWN1cml0eUBlZGdlZ2FsbGVyeS5vcmc+iQFUBBMBCAA+FiEErjom
vODc7Jujsi7EebnIvPVgGPwFAl8G3IUCGwMFCQlnDLsFCwkIBwIGFQoJCAsCBBYC
AwECHgECF4AACgkQebnIvPVgGPxWZAf/cwoeCLACu5blKu3klaCpjeyhzrfQr2CI
VKrwIAB8FcZZzjaORlu47fgDyPAVhyjFJl4zc+tx2qZIk9JHAG5Klh7uaWcocK1d
TQjlknHBW7Aj3rxsem1Gh38z6NyzVByleijp62rLctD0LR0C5ySj58mjJ/5E+l6J
3sv/WPaAu82AzaWZUdGdXFoImkI1S9VEeC7RJ6X+LZeQijXWtEISIS9+3ptpBRa7
pHTn3CRTreD2FZcWFmIJTSRuXza1gLqCUlV0A8pPPNTTGBMykiOjQTc/dwQBqVko
wnYYcT+OVzFsgp3+iWObdX9xO3ejE68qDMKa8krZporq40idA1Z597kBDQRfBtyF
AQgArAspG2LotsPNh9BTrGDt+Bd5HwIIJMZOyiidd2pFY/GIWfGL0mRvlctClg23
0vR4GahKzk1rhP/ibpRvUMG/Qt+wwg2nQpM/Ey8fjYNXRYjlv6Pw2+g23oWA6c3j
PhR6IT2JuUkvdsPB8Jfd3tlDkifOwYbHVbCv5YSx6F6XHFR6pjC9Wm7SiUU8mP+i
nLK39XZxJk2po9ajBe+IqP/NDVNLo6CobeSlYqcap4FNsTbrG62EGEn0z2kUqVaI
ZEVhur/PSOSeRu1ThAOkkSu9siaXSZtj3ZC6DrbPZljrwLH5ZzkHdAlcgGC5n7gZ
z6RQJGsJicjn9DRtbnovY1b+yQARAQABiQE8BBgBCAAmFiEErjomvODc7Jujsi7E
ebnIvPVgGPwFAl8G3IUCGwwFCQlnDLsACgkQebnIvPVgGPyvRwgAme0z4W/jmcLu
ewJh5gsL7Gc7kCY327zrFu1K24zKgDDECl5ACDUXGZ74hL+WqYWdUOkDGFFBxa5S
uqIgXR35VkkPkecwhZ0WY0ofLIPMAaKur6O3VVKiB2kVRTrqXUNO7/yKyDhirS6g
oXK4vLWkV+Jhu0LYeLeSt/CEstUpmzQz0jYdk0jxnWah7T03SnuBSBBZrSZYBFrW
9SiM+slwgMWC1TOwqW/jJaLysDi/7c0wDee3cpsdASL+6GHWRDK6EWZ79DTB1bO6
Iq2YsidCPX+QEh3o1IHYBtlqNgKIul42plTrxfu/1oxiIjdT4dtkQ7fbIrPSwA6b
N/m7e/KL4A==
=p+CN
-----END PGP PUBLIC KEY BLOCK-----
```

### Security Issue Disclosure Process

After receiving the issues, we will handle the security issues according to the following process:

- After receiving suspected security issues, the vulnerability management team (VMT) immediately confirms the integrity of reported information and issue severity.
- Organize community teams to carry out technical analysis, confirm issue details, and provide analysis reports.
- Confirm the vulnerability and apply for CVE, communicate with the vulnerability reporter about the issue, align the subsequent fixing and release plan, and prepare the security advisory (SA).
- Complete vulnerability patch development/verification and initiate restricted disclosure.
- Publicly release patches and security advisory (SA).

#### Triage
The bug must then be confirmed to be a security problem and assigned initial severity level. This may require the inclusion of additional subject matter experts to determine if the problem needs to be treated as a security flaw. If the bug is determined not be a security issue then a statement should be added indicating the justification. The bug should then be opened and fixed by following the normal development process.

**Steps to be completed:**

1.  Identify affected projects and versions

2.  Update bug description with data mentioned above

3.  Perform initial severity assessment

4.  Label task with a suitable severity level and add impact description

5.  Add PTL or security responsible person of affected project to the bug

**Extra steps for critical vulnerabilities**

1.  Extreme caution is necessary while handling this bug.

2.  Secure communication channel with PTL or project security contact point should be established (GPG, zoom with e2e encryption enabled etc)

**All Vulnerabilities**

1.  PTL or project security contact point should receive bug details to confirm initial severity

2.  Severity level should be fixed:

    a.  If PTL or project security contact point agrees with initially assigned severity a "Severity-confirmed" label should be added to the task.

    b.  If PTL or project security contact point disagrees with initially assignment, a clear justification should be provided, severity level updated and "Severity-confirmed" added to the task.

3.  If a bug has been received via email the triage confirmation email should be sent to the reporter.

**Hardening opportunities**

1.  If received ticket is not a security bug which can be fix with a patch of reasonable size but a good hardening idea, the ticket visibility should be set to public and "Hardening" label should be added

2.  After public discussion, it will be determined if resources should be assigned for this task.

**Non-Security bugs**

1.  If bug has been classified as a non-security, the ticket should be made publicly visible

2.  PTL of impacted project is responsible for further handling of this bug

#### Patch development

The PTL or project security contact point is responsible for fixing the bug or delegating the work to the subject matter experts. Even through patch development can be delegated by PTL or project security contact, only the VMT has a right to add new people to the ticket. Thus, the PTL should explicitly request access for additional developers by adding a comment with their Jira username.

A fix should be prepared against current master branch and other supported affected branches and attached to the ticket. **Do not sent it to the public code review system (GitHub) unless the ticket is already public.**

Security fixes, especially critical should be treated as **highest-priority tasks**. If project delays are encountered at this or any subsequent stage of the process, the VMT and other interested parties may escalate the issue to the TSC but without providing any details on bug itself apart from reporter, severity, impacted project and versions.

**Steps to be completed:**

1.  Develop the fix **(PTL or delegate)**

2.  **Do not sent it to the public code review system (GitHub) unless the ticket is already public.**

#### Patch review

Once the patch has been attached to the ticket, patch should be reviewed and pre-approved by PTL or delegated committers. Privately-developed patches need to be pre-approved so that they can be fast-tracked through public code review later at disclosure time.

For public reports, usual public code review process apply.

**Steps to be completed:**

1.  Review the fix **(PTL and committers)**

2.  Pre-approve fix by providing a comment to the ticket "Acked-by: Name Surname <email@domain.tld>" **(PTL, committers and VMT coordinator)**

3.  When all required approval are collected, commit message should be updated and  comments from the previous step should be added to the commit message **(VMT coordinator)**

#### Draft Vulnerability description

While the patch is being developed, the VMT coordinator prepares a vulnerability description that will be communicated to downstream stakeholders, and will serve as the basis for the Security Advisory that will be finally published.

The description should properly credit the reporter, specify affected versions (including unsupported ones) and accurately describe impact and mitigation mechanisms. The VMT coordinator should use the template below.

**Steps to be completed:**

1.  Prepare draft of vulnerability description

#### Review impact description

The description is validated by the reporter and the PTL.

**Steps to be completed:**

1.  Review the draft of vulnerability description **(PTL and commiters)**

#### Send CVE request

If reporter did not request for a CVE number on his or her own, VMT coordinator should attempt to obtain one to ensure full traceability. This is generally done as the patch gets nearer to final approval. The approved impact description is submitted through [MITRE’s CVE Request form](https://cveform.mitre.org/). The _request type_ is `Request a CVE ID`, the _e-mail address_ should be that of the requester, and for critical reports the coordinator’s OpenPGP key should be pasted into the field provided.

In the _required_ section set the check boxes indicating the product is not CNA-covered and that no prior CVE ID has been assigned, select an appropriate _vulnerability type_ (using `Other or Unknown` to enter a free form type if there is nothing relevant on the drop-down), set the _vendor_ to `EdgeGallery`, and the _product_ and _version_ fields to match the `affected project name` and `version` from the impact description. In the _optional_ section set the radio button for _confirmed/acknowledged_ to `Yes`, choose an appropriate _attack type_ in the drop-down (often this is `Context-dependent` for our cases), check the relevant _impact_ checkboxes, attempt to fill in the _affected components_ and _attack vector_ fields if possible, paste in the _suggested description_ from the prose of the impact description (usually omitting the first sentence as it’s redundant with other fields), put the `$CREDIT` details in the _discoverer/credits_ field, and the bug URL (along with GitHub URLs for patches if already public) in the _references_ field. If the report is still private, note that in the _additional information_ field like `This report is currently under embargo and no disclosure date has been scheduled at this time.`

At the bottom of the page, fill in the _security code_ and click the _submit request_ button. If some fields contain invalid data they will be highlighted red; correct these, update the _security code_ and _submit request_ again until you get a confirmation page.

**Steps to be completed:**

1.  Request CVE number from MITRE  

#### Get assigned CVE

MITRE returns the assigned CVE. VMS coordinator adds it to the jira ticket, and retitles the bug to “$TITLE ($CVE)”.

**Steps to be completed:**

1.  Receive the assigned CVE number

2.  Add received CVE number to the Jira ticket

3.  Re-title the ticket to “$TITLE ($CVE)”

#### Embargoed disclosure

Once the patches are approved and the CVE is assigned, a signed email with the vulnerability description is sent to the downstream stakeholders by VMT coordinator or other designated VMT member. The disclosure date is set to 3-5 business days, excluding Monday/Friday and holiday periods, at 1400 UTC. No stakeholder is supposed to deploy public patches before disclosure date.

For non-embargoed, public vulnerabilities no separate downstream advance notification is sent.

**Steps to be completed:**

1.  Set up disclosure date with the reporter, PTL and required committers.

2.  Add note about planned disclosure date to the ticket

3.  Send a PGP signed email with vulnerability description to downstream stakeholders.

#### Coordinated disclosure

In preparation for this, make sure you have a PTL available to help pushing the fix at disclosure time.

On the disclosure hour, open ticket to public, push patches to GitHub for review on master.

PTL and committers who pre-approved the patch should, as soon as possible review the pushed patch and merge it.

Publish the EdgeGallery Security Advisory and update the ticket title to “\[ESA-$NUM\] $TITLE”.

Embargo reminder can be removed at that point.

[MITRE’s CVE Request form](https://cveform.mitre.org/) should be used again at this point, but instead select a _request type_ of `Notify CVE about a publication` and fill in the coordinator’s _e-mail address_, provide a _link to the advisory_ (the URL to official ESA), the _CVE IDs_ covered, and the _date published_. Once more, fill in the _security code_ at the bottom of the page and _submit request_.

Steps to be completed:

1.  Ensure that PTL and committers are available

2.  On the disclosure hour:

    a.  Remove embargo notice from ticket description

    b.  Open the ticket to public

    c.  Push attached patches for review on master

    d.  Notify PTL and committers that patch is ready to be merged

3.  Publish EdgeGallery security advisory

4.  Update the ticket title to “\[ESA-$NUM\] $TITLE”

5.  Sent notification to MITRE about a publication

## Security Issue Reporting Template

| Content | Related Information                                                                                                 |
| :------ | :------------------------------------------------------------------------------------------------------------------ |
| Reporter |                                                                                                                    |
| Contact Information |                                                                                                         |
| Organization Information | Individual/Team/Corporate                                                                          |
| Issue Description	|                                                                                                           |
| Impact Version |                                                                                                              |
| Impact Scenario | OS information Service scenario information                                                                 |
| Impact Scope |                                                                                                                |
| Issue Details | If the issue is a public vulnerability, provide the CVE number. However, if the CVE number is not disclosed, provide the attack method and result, and attach any other necessary information, such as related code and logs. |
| Fix Suggestion |                                                                                                              |